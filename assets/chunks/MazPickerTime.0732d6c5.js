import{u as F,d as M,r as n,q as P,v as d,b as _,m as x,n as $,a as g,F as b,D as w,C as G,O as W,L as X,X as J,a0 as K,G as y,_ as Q}from"./framework.14a11354.js";import{f as B,M as R,s as U}from"./index.c91fa2fb.js";import{d as i}from"./dayjs.min.04d70162.js";import"./chart.705aa2e5.js";import"./use-maz-dialog-promise.fd0fe92b.js";import"./zoom-img.f640e524.js";import"./lazy-img.179ac20a.js";import"./inject-strict.193b88a6.js";import"./currency.a4106e0e.js";import"./click-outside.aec93d11.js";import"./date.0d08a58e.js";import"./capitalize.43002998.js";const Y={class:"m-picker-time__column__items"},Z=F({__name:"MazPickerTime",props:{modelValue:{type:[String,Object],default:void 0},calendarDate:{type:String,required:!0},formatterOptions:{type:Object,required:!0},locale:{type:String,required:!0},color:{type:String,required:!0},isOpen:{type:Boolean,required:!0},hasDate:{type:Boolean,required:!0},minuteInterval:{type:Number,required:!0},disabledHours:{type:Array,default:void 0},format:{type:String,required:!0},isHour12:{type:Boolean,required:!0},minDate:{type:String,default:void 0},maxDate:{type:String,default:void 0},disabled:{type:Boolean,required:!0}},emits:["update:model-value"],setup(v,{emit:S}){const s=v,z=e=>{if(!s.disabledHours)return e;const t=Array.from({length:24},(a,o)=>o).filter(a=>{var o;return!((o=s.disabledHours)!=null&&o.includes(a))}),r=B(t,e);return r!==e&&q("hour",i(u.value).set("hour",r)),r},l=M(),m=M(),p=n(()=>typeof u.value=="string"?z(i(u.value).get("hour")):void 0),A=n(()=>typeof u.value=="string"?B(H.value.map(({value:e})=>e.get("minute")),i(u.value).get("minute")):void 0),T=e=>{if(s.isHour12){const r=h.value==="pm"?e+12:e;return r===12?0:r===24?12:r}else return e},O=n(()=>Array.from({length:s.isHour12?12:24},(e,t)=>t).map(e=>{const t=e+(s.isHour12?1:0),r=T(t),a=i(u.value).set("hour",r),o=I(r)||(s.minDate&&u.value?i(s.minDate).isAfter(a,"hour"):!1)||(s.maxDate&&u.value?i(s.maxDate).isBefore(a,"hour"):!1);return{label:`${t<10?"0":""}${t}`,value:i(u.value).set("hour",r),isDisabled:o}})),H=n(()=>{const e=Math.floor(60/s.minuteInterval)-0;return Array.from({length:e},(t,r)=>r*s.minuteInterval).map(t=>{const r=i(u.value).set("minute",t),a=(s.minDate&&u.value?i(s.minDate).isAfter(r,"minute"):!1)||(s.maxDate&&u.value?i(s.maxDate).isBefore(r,"minute"):!1);return{label:`${t<10?"0":""}${t}`,value:r,isDisabled:a}})}),h=n(()=>typeof p.value=="number"?p.value>=12?"pm":"am":void 0),j=n(()=>s.isHour12?[{label:"AM",value:"am"},{label:"PM",value:"pm"}]:[]),C=n(()=>{const e=[{identifier:"hour",values:O.value},{identifier:"minute",values:H.value}];return s.isHour12&&e.push({identifier:"ampm",values:j.value}),e}),u=n({get:()=>s.modelValue,set:e=>{S("update:model-value",e)}});P(()=>s.isOpen,async e=>{var t;if(e){if(await y(),l.value){const r=l.value.querySelector(".m-picker-time__column .m-btn"),a=r==null?void 0:r.offsetHeight,c=((t=l.value)==null?void 0:t.offsetHeight)/2-a/2;m.value=c/16}k(!1)}},{immediate:!0}),P(()=>s.modelValue,async(e,t)=>{e!==t&&(await y(),k(!0))},{immediate:!0});const k=e=>{f("hour",e),f("minute",e),s.isHour12&&f("ampm",e)},I=e=>(s.disabledHours&&s.disabledHours.includes(e))??!1,D=(e,t)=>t==="am"||t==="pm"?h.value===t:e==="hour"?p.value===t.get(e):e==="minute"?A.value===t.get(e):!1,f=async(e,t=!0)=>{if(l.value){const r=l.value.querySelector(`.m-picker-time__column__${e}`),a=l.value.querySelector(`.m-picker-time__column__${e} .--is-selected`);m.value&&r&&a&&l.value&&(await y(),U(r,a,m.value*16,t))}},q=async(e,t)=>{const r=i(u.value);if(e==="hour"&&typeof t=="object"&&(u.value=r.set("hour",t.get("hour")).format()),e==="minute"&&typeof t=="object"){const a=r.set("minute",t.get("minute"));u.value=a.format()}if(e==="ampm"&&(h.value!==t||!p.value)&&(t==="am"&&(u.value=r.set("hour",r.get("hour")).subtract(12,"hour").format()),t==="pm")){const a=r.get("hour"),o=a+12>12&&a+12<24?a+12:a===0?12:a;u.value=r.set("hour",o).format()}await y(),f(e)};return(e,t)=>(d(),_("div",{ref_key:"MazPickerTime",ref:l,class:g(["m-picker-time",{"--has-date":v.hasDate}])},[(d(!0),_(x,null,$(C.value,({values:r,identifier:a},o)=>(d(),_("div",{key:o,class:g(["m-picker-time__column",[`m-picker-time__column__${a}`]])},[b("div",{style:w({height:`${m.value}rem`}),class:"m-picker-time__column__divider"},null,4),b("div",Y,[(d(!0),_(x,null,$(r,({value:c,label:N,isDisabled:L},V)=>(d(),G(R,{key:V,size:"xs",color:D(a,c)?v.color:"transparent",class:g({"--is-selected":D(a,c)}),disabled:L||v.disabled,type:"button",onClick:K(E=>q(a,c),["stop"])},{default:W(()=>[X(J(N),1)]),_:2},1032,["color","class","disabled","onClick"]))),128))]),b("div",{style:w({height:`${m.value}rem`}),class:"m-picker-time__column__divider"},null,4)],2))),128))],2))}});const de=Q(Z,[["__scopeId","data-v-463999ca"]]);export{de as default};
